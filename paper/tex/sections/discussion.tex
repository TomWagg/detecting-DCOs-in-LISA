In this section we discuss the prospects of (and methods for) identifying LISA sources (Sec.~\ref{sec:identify_sources}), the possibility of matching LISA signals to SKA detections (Sec.~\ref{sec:pulsar_matching}) and the main caveats for this study (Sec.~\ref{sec:caveats}).

\subsection{Identification of GW sources}\label{sec:identify_sources}
It is important to note that, though we present predictions for the detection rates of specific DCO types, the nature of the source may not be immediately apparent from the gravitational wave signal. LISA can detect a variety of sources, from exoplanets \citep[e.g.][]{Tamanini+2019} to common-envelopes \citep[e.g.][]{Ginat+2020, Renzo+2021} that may cause confusion. However, by far the most prominent will be the population of Galactic WDWDs detectable with LISA, which will be several orders of magnitude larger than the population of the more massive DCOs that we focus on in this paper \citep[e.g.][]{Korol+2017}. It is therefore imperative that we consider how to distinguish NS and BH binaries from this much more numerous population of sources. In addition to distinguishing them from WDWDs, we must consider how to discriminate between BHBHs, BHNSs and NSNSs themselves.

\subsubsection{Distinguishing from WDWD population}\label{sec:WDWD_distinguish}
The simplest way to check whether a source is a WDWD is to evaluate its chirp mass. The mass of a non-rotating white dwarf cannot be larger than the Chandrasekhar limit of $1.4 \unit{M_\odot}$ \citep{Chandrasekhar+1931, Hamada+1961}, so we can take the maximum chirp mass of a WDWD to be $\sim 1.2 \unit{M_{\odot}}$. Therefore, any DCO with a chirp mass that satisfies $\mathcal{M}_c > 1.2 \unit{M_{\odot}} + \Delta \mathcal{M}_c$ must not be a WDWD (where $\Delta \mathcal{M}_c$ is calculated using Eq.~\ref{eq:chirp_mass_uncertainty}). We find that for the detectable population of a 4(10)-year LISA mission, \BHBHAboveMaxWDWDFourPerc{}(\BHBHAboveMaxWDWDTenPerc{})\% of BHBHs, \BHNSAboveMaxWDWDFourPerc{}(\BHNSAboveMaxWDWDTenPerc{})\% of BHNSs and \NSNSAboveMaxWDWDFourPerc{}(\NSNSAboveMaxWDWDTenPerc{})\% of NSNSs satisfy this condition. This method is not particularly effective for NSNSs since their average chirp mass, $1.17 \unit{M_\odot}$, is below the Chandrasekhar limit.

Another discriminator between WDWDs and other DCOs is eccentricity. WDWDs formed in the disc are thought to be formed mainly through isolated binary formation and have little to no eccentricity (e.g.\ \citealt{Nelemans+2001}, see however \citealt{Dosopoulou+2016a, Dosopoulou+2016b, Gosnell+2019}). This is because WDWDs formed through isolated binary evolution all experience a phase of mass transfer or a common envelope, which circularises the binary \citep[e.g.][]{Marsh+2004}. However, in contrast to the more massive DCOs that we study, WDWDs do not experience strong natal kicks which we find to be the main source of eccentricity. Therefore, if any system is detected with anything other than one detectable harmonic, this suggests that the system is unlikely to be a WDWD. We find that for a 4(10)-year LISA mission, \BHBHMultipleHarmonicsFourPerc{}(\BHBHMultipleHarmonicsTenPerc{})\% of BHBHs, \BHNSMultipleHarmonicsFourPerc{}(\BHNSMultipleHarmonicsTenPerc{})\% of BHNSs and \NSNSMultipleHarmonicsFourPerc(\NSNSMultipleHarmonicsTenPerc{})\% of NSNSs are detected with multiple harmonics. Both the absolute percentage and the relative improvement with an extended LISA mission is lower for the BHNSs with respect to other DCOs as we find that these BHNSs are less eccentric on average (see Fig.~\ref{fig:fiducial_pdf_distributions} and discussion in Sec.~\ref{sec:fiducial_distributions}).

However, we should also consider that eccentric WDWDs could be formed through dynamical formation in Milky Way globular clusters \citep[e.g.][]{Willems+2007, Kremer+2018}. This means that we cannot assume that eccentric binaries are not WDWDs unless they are detected in the Galactic plane (though even then there is a chance they were formed dynamically). We can use the sky localisation, scale height of the disc and distance to the source to estimate what fraction of eccentric sources can be localised to the Galactic plane. This condition can be written as $\sigma_\theta < \arcsin(z_{\rm plane} / D_L)$ or $D_L < z_{\rm plane}$, where we set the height of the Galactic plane, $z_{\rm plane}=0.95 \unit{kpc}$, to the scale height of the high-$\alpha$ disc. We apply this condition to find that the fraction of sources that are eccentric \textit{and} localised within the disc for a 4(10)-year LISA mission are \BHBHEccInDiscFourPerc{}(\BHBHEccInDiscTenPerc{})\% for BHBHs, \BHNSEccInDiscFourPerc{}(\BHNSEccInDiscTenPerc{})\% for BHNSs and \NSNSEccInDiscFourPerc{}(\NSNSEccInDiscTenPerc{})\% for NSNSs. Note that although the fractions are the same for the 10-year mission, the \textit{absolute} number of detections is still greater. Overall, combining these methods we find that for a 4(10)-year mission, LISA will detect at least \BHBHNotWDWDFour{}(\BHBHNotWDWDTen{}) BHBHs, \BHNSNotWDWDFour{}(\BHNSNotWDWDTen{}) BHNSs and \NSNSNotWDWDFour{}(\NSNSNotWDWDTen{}) NSNSs that are distinguishable from the WDWD population.

We highlight here that, though the overall number of LISA detections in an extended mission only increases by a factor of $\sqrt{T_{\rm obs}}$, the number of \textit{distinguishable} detections increases by a greater factor since each of the more numerous sources are better measured. This further underlines the benefits of extending the LISA mission to 10 years.

\subsubsection{Discriminating between BHBHs, BHNSs and NSNSs}

The problem of discriminating between the BHBH, BHNS and NSNS populations can be more difficult than distinguishing them from WDWDs. For NSNSs, we can follow a similar method to the WDWDs (see Sec.~\ref{sec:WDWD_distinguish}) by applying our knowledge of the maximum mass of a neutron star. Following our fiducial assumption, we can take the maximum mass of a neutron star as $2.5 \unit{M_{\odot}}$ and thus the maximum chirp mass that a system can attain without one of the components being a black hole is $\mathcal{M}_{c} = 2.2 \unit{M_\odot}$. For a 4(10)-year LISA mission, the fraction of systems that are above or below this limit (and thus \textit{must} respectively contain or not contain a BH component) by more than $\Delta \mathcal{M}_c$ is \BHBHEitherBHOrNSFourPerc{}(\BHBHEitherBHOrNSTenPerc{})\% for BHBHs, \BHNSEitherBHOrNSFourPerc{}(\BHNSEitherBHOrNSTenPerc{})\% for BHNSs and \NSNSEitherBHOrNSFourPerc{}(\NSNSEitherBHOrNSTenPerc{})\% of NSNSs, which in terms of absolute detections is \BHBHEitherBHOrNSFour{}(\BHBHEitherBHOrNSTen{}) for BHBHs, \BHNSEitherBHOrNSFour{}(\BHNSEitherBHOrNSTen{}) for BHNSs and \NSNSEitherBHOrNSFour{}(\NSNSEitherBHOrNSTen{}) for NSNSs.

For separating the BHBH and BHNS population one could do so probabilistically given the properties that are measured, particularly the orbital frequency, mass ratio and eccentricity, since these distributions are fairly different for the two DCO types (see Fig.~\ref{fig:fiducial_pdf_distributions}). This method would pose a challenge, however, as it would likely only indicate which type was more likely rather than discriminate between them with strong evidence.

Another possible solution would be the existence of electromagnetic counterparts to the gravitational wave signal. In Section~\ref{sec:pulsar_matching} we consider the possibility of detecting a pulsar within a BHNS or NSNS system. This could be used to identify the type of the source.

\subsection{Matching LISA detections to pulsars with SKA}\label{sec:pulsar_matching}
Since the vast majority of the LISA detectable population of DCOs will not merge for many years, the main type of electromagnetic counterpart for this population is pulsars. Therefore, for this section we focus only on BHNSs and NSNSs since no BHBH system will contain a pulsar. The joint detection of a binary pulsar with LISA and SKA would not only help to constrain the parameters of the binary, but also enable investigation of other compact object physics. A pulsar(PSR)+BH can provide stringent tests of theories of gravity, in particular the ``No-hair theorem'' \citep{Keane+2015}. Alternatively, an ultrarelativstic PSR+NS system could be used to measure the neutron star equation of state up to an order of magnitude more accurately than other proposed observational constraints \citep{Kyutoku+2019, Thrane+2020}.

We estimate that on average, given the number of detectable pulsars and SKA sky area, each pulsar in SKA occupies a region with an angular resolution of $\sigma_{\theta} < 1.3^\circ$ or $0.7^\circ$ for SKA-1 and SKA-2 respectively (see Appendix~\ref{app:ska_area}). Therefore, any DCOs containing NSs localised by LISA with an angular resolution lower than these values can be unambiguously matched to the radio signal in SKA. By considering Fig.~\ref{fig:ang_res}, approximately $11$ and $6$ (for SKA-1 and SKA-2) DCOs will satisfy this constraint.

If there is more than one pulsar in the region given by the LISA sky localisation, one can compare the measured parameters of the system in LISA and SKA. Both SKA and LISA will measure the orbital frequency to high precision, as well as the time derivative of the frequency and chirp mass to a lesser precision, of each of these systems. Therefore, one could perform a targeted search with SKA that checks the sky location given by LISA, only looking for binary pulsars with orbital frequencies within the uncertainties. If there was \textit{still} more than one possible pulsar one could also check against the chirp mass. In this way, we expect it will be possible to get a joint detection between SKA and LISA even when the sky area implied by the LISA detection contains more than one pulsar.

In order to assess the efficacy of this method, we would need to know the probability that two random binary pulsars would have orbital frequencies and chirp masses close enough that one could not tell which pulsar matches the LISA detection. This would require simulating the SKA population of pulsars with a code such as PSRPOPPy \citep{Bates+2014} to find the frequency and chirp mass distribution, which is beyond the scope of this paper. However, the uncertainty in the orbital frequency of a binary on the detection threshold (${\rm SNR} = 7$) for a 4-year LISA mission is $2.5 \times 10^{-9} \unit{Hz}$ and $1.0 \times 10^{-9} \unit{Hz}$ for a 10-year mission (calculated using Eq.~\ref{eq:f_orb_unc}). Therefore, we expect that SKA could likely isolate the correct binary pulsar to match to a LISA detection even when several are present in the sky localisation region.

\subsection{Caveats}\label{sec:caveats}

\textit{Population synthesis limitations:} As with any study involving a rapid population synthesis code, our results rely on uncertain stellar and binary physics and the use of approximate fitting formulae. COMPAS uses fitting formulae and approximate prescriptions based on (sometimes limited) grids of detailed models to describe the evolution of binary stars \citep{COMPAS:2021methodsPaper}. Much of the underlying physics is uncertain, such as the common-envelope evolution and mass transfer physics. We attempt to understand the importance of some these assumptions by varying over many different physics assumptions.

\textit{Large progenitor masses:} Many of the black holes that are formed in our sample come from progenitors with large initial masses. The primary stars in systems that form BHNSs and BHBHs have very large primary progenitor masses that peak around 50\Msun and 80\Msun, but these masses extend up to 150\Msun. The evolution of such massive progenitor stars is very poorly understood and observational constraints are very scarce in this mass range and practically non-existent for the later rapid evolutionary phases. For these reasons, the COMPAS code relies on heavily extrapolated fitting formulae to create evolutionary tracks for these higher mass progenitors. This leads to substantial uncertainties in our final predictions which are unfortunately still hard to quantify at present.

\textit{Underlying helium star models:} One source of weakness is that the \citet{Hurley+2000} fitting formulae (used by COMPAS) for the evolution of helium stars are based on a grid of models from $0.3 \unit{M_{\odot}}$ to $10 \unit{M_{\odot}}$, for a single metallicity ($Z= 0.02$) and thus the formulae have no metallicity dependence and are extrapolated for higher masses. A more comprehensive set of models in this regime could lead to large changes in the evolution of naked helium stars, a common progenitor of DCOs, and thus affect the detection rate of DCOs.

\textit{Limited metallicity range:} The stellar evolution fitting formulae that COMPAS uses is limited to a metallicity range of $10^{-4} \le Z \le 0.03$ \citep{Hurley+2000} and should not be extrapolated too far outside this range. However, in our simulated Milky Way (based on the metallicity relation in \citealt{Frankel+2018}), the metallicity distribution can extend as far as $10^{-5} \le Z \le 0.06$, with a significant fraction of star formation occurring past $Z = 0.03$. 

For metallicities below the range allowed by COMPAS, we assume that binaries evolve similar to our lowest metallicity models. DCO formation at metallicities above $Z = 0.03$ is significantly less efficient for increasing metallicity. And so, higher metallicities are unlikely to contribute significantly. Therefore, we place any sampled metallicity above the maximum of $Z = 0.03$ uniformly randomly in one of the top 5 highest metallicity bins that range across $0.01416 < Z < 0.03$ (since using a single metallicity for many binaries leads to unphysical artifacts).

\textit{Normalisation choices}: The choice of the binary fraction has a strong effect on our results. For the normalisation of the detection rate we conservatively choose to set the binary fraction of all stars to 50\%. The binary fraction is uncertain and not well constrained, though we know it is higher for more massive stars \citep[e.g.][]{Sana+2012}. Increasing it to 70\% and 100\% would increase our expected detection rates for every physics variation by 30\% and 67\% respectively. Moreover, we assume that the mass ratio of secondary stars is uniformly distributed and this could also have strong effect on our results. We highlight this uncertainty in the normalisation to point out that the exact magnitude of the rates in each case could change as our understanding shifts. However, changes to this normalisation would affect every variation equally and so the trends across variations are more robust.

\textit{Systemic kicks:} We do not include the effect of systemic kicks on the final location of the sources. This would require integrating the orbital evolution of the millions of binaries in our sample and thus was not computationally reasonable to include. We investigated the effect of kicks for a small grid of binaries and found that, though they would result in a more spread out distribution (with a smaller concentration in the Galactic centre) and larger heights above the plane, the overall distribution of positions would be relatively unchanged and very few sources have strong enough kicks to reach escape velocity for the Milky Way.

\textit{Eccentricity measurement uncertainty:} The method that we use to determine the eccentricity uncertainty is pessimistic as it requires each harmonic to be individually detectable \citep[e.g.][]{Lau+2020}. In reality this may not be necessary depending on the efficacy of matched-filter analysis of LISA data. For an eccentric source to have been detected within the LISA data, several harmonics would already have to have been matched as originating from the same source. This could be done by looking in the same region of the sky for signals with similar chirp masses and distances to the most detectable harmonic in order to find other harmonics that are below the regular detection threshold. This would allow one to refine the measurement of the eccentricity uncertainty significantly by comparing the many different harmonics. Therefore, the eccentricity uncertainty that we calculate in this study is a pessimistic estimate. Smaller eccentricity uncertainties would have two main effects on our results. Firstly, the chirp mass error would decrease slightly in the cases where it is dominated by the eccentricity uncertainty. However, it is mainly dominated by the frequency derivative uncertainty since most sources are essentially stationary in frequency. Secondly, it would improve our ability to distinguish between WDWDs and higher mass DCOs. Until we know more about how LISA will search for eccentric sources, we rely upon our pessimistic estimates.

\textit{Other formation channels, the Halo, globular clusters and young stellar clusters:} Our model for the Milky Way, though more extensive than many previous studies, does not consider the contributions from the Galactic halo, globular clusters or young massive and open stellar clusters. \citet{Lamberts+2018} found that the halo's contribution to the detection rate was minimal and, since the metallicity distribution of the halo is uncertain, we did not include it in our galaxy model. The impact of globular clusters would have required a more detailed look into dynamical formation that was beyond the scope of this paper but we highlight the work of \citet{Kremer+2018} that investigated these rates. Similarly, we did not consider DCO formation in young massive and open stellar clusters but \citet{Banerjee+2020} finds that the LISA detection rates could be even higher than contributions from isolated binary formation.

